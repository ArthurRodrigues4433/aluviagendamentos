<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://public-frontend-cos.metadl.com/mgx/img/favicon.png" type="image/png">
    <title>SaaS Agendamento - Agende seu serviÃ§o</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/frontend/assets/styles.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#60A5FA">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Aluvi">
    <link rel="apple-touch-icon" href="/frontend/assets/icon-192x192.png">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="/" class="logo">âœ¨ Aluvi Agendamentos</a>
                <ul class="nav-links">
                    <li><a href="/login.html">ğŸ” Login</a></li>
                    <li><a href="/register.html">ğŸ“ Cadastro</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>O tempo estÃ¡ do seu lado</h1>
            <p>O Aluvi Ã© a base para negÃ³cios que querem escalar com organizaÃ§Ã£o e agilidade.</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Funcionalidades do Sistema -->
        <section class="card">
            <div class="card-header">
                <h2 class="card-title">ğŸ¯ Funcionalidades do Sistema</h2>
                <p>Descubra tudo que nosso sistema pode fazer por vocÃª</p>
            </div>
            
            <div class="grid grid-2">
                <!-- Card Agendamento -->
                <div class="form-group">
                    <div class="service-card" style="background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; height: 100%;">
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1.1rem; font-weight: 600;">ğŸ“… Agendamento fÃ¡cil</h3>
                        <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem; line-height: 1.4;">Marque e acompanhe compromissos de forma simples e intuitiva.</p>
                    </div>
                </div>

                <!-- Card GestÃ£o de Clientes -->
                <div class="form-group">
                    <div class="service-card" style="background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; height: 100%;">
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1.1rem; font-weight: 600;">ğŸ‘¤ GestÃ£o de clientes</h3>
                        <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem; line-height: 1.4;">Organize informaÃ§Ãµes de todos os seus clientes em um sÃ³ lugar.</p>
                    </div>
                </div>

                <!-- Card Controle de ServiÃ§os -->
                <div class="form-group">
                    <div class="service-card" style="background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; height: 100%;">
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1.1rem; font-weight: 600;">ğŸ’¼ Controle de serviÃ§os</h3>
                        <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem; line-height: 1.4;">Cadastre e gerencie todos os seus serviÃ§os com facilidade.</p>
                    </div>
                </div>

                <!-- Card Pontos De Fidelidade -->
                <div class="form-group">
                    <div class="service-card" style="background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; height: 100%;">
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1.1rem; font-weight: 600;">ğŸ Pontos de Fidelidade</h3>
                        <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem; line-height: 1.4;">Cada agendamento gera pontos. Seus clientes acumulam, trocam por benefÃ­cios e voltam com mais frequÃªncia. Simples, automÃ¡tico e eficaz.</p>
                    </div>
                </div>

                <!-- Card Dashboards -->
                <div class="form-group">
                    <div class="service-card" style="background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; height: 100%;">
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1.1rem; font-weight: 600;">ğŸ“Š Dashboards Inteligentes Cliente e Dono</h3>
                        <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem; line-height: 1.4;">Clientes acompanham agendamentos e pontos. Donos gerenciam tudo com dados em tempo real. Cada um com a visÃ£o certa, no lugar certo.</p>
                    </div>
                </div>

                <!-- Card NotificaÃ§Ãµes -->
                <div class="form-group">
                    <div class="service-card" style="background: var(--input-bg); border: 1px solid var(--border-color); border-radius: 12px; padding: 1.5rem; height: 100%;">
                        <h3 style="color: var(--text-primary); margin-bottom: 0.5rem; font-size: 1.1rem; font-weight: 600;">ğŸ”” NotificaÃ§Ãµes inteligentes</h3>
                        <p style="color: var(--text-secondary); margin: 0; font-size: 0.9rem; line-height: 1.4;">Receba lembretes automÃ¡ticos e mantenha-se sempre organizado.</p>
                    </div>
                </div>
            </div>

            <!-- BotÃ£o de Login -->
            <div class="text-center" style="margin-top: 2rem;">
                <a href="/login.html" class="btn btn-primary">
                    âœ¨ Fazer Login para Acessar âœ¨
                </a>
            </div>
        </section>

        <!-- Lista de ServiÃ§os DisponÃ­veis -->
        <section class="card">
            <div class="card-header">
                <h2 class="card-title">ğŸŒŸ Nossos ServiÃ§os</h2>
                <p>ConheÃ§a todos os serviÃ§os disponÃ­veis</p>
            </div>
            <div id="servicesList" class="grid grid-3">
                <div class="loading">Carregando serviÃ§os...</div>
            </div>
        </section>

        <!-- SeÃ§Ã£o de Recursos -->
        <section class="card">
            <div class="card-header">
                <h2 class="card-title">ğŸš€ Por que escolher nosso sistema?</h2>
            </div>
            <div class="grid grid-3">
                <div class="service-card">
                    <h3>âš¡ RÃ¡pido e FÃ¡cil</h3>
                    <p>Agende em poucos cliques, sem complicaÃ§Ãµes. Nossa interface intuitiva torna o processo simples e eficiente.</p>
                </div>
                <div class="service-card">
                    <h3>ğŸ”’ Seguro e ConfiÃ¡vel</h3>
                    <p>Seus dados estÃ£o protegidos com as mais avanÃ§adas tecnologias de seguranÃ§a e criptografia.</p>
                </div>
                <div class="service-card">
                    <h3>ğŸ“± Responsivo</h3>
                    <p>Acesse de qualquer dispositivo - computador, tablet ou smartphone. Sempre com a melhor experiÃªncia.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Scripts -->
    <script src="/frontend/config.js"></script>
    <script src="/frontend/app.js"></script>
    <script>
        // Registrar Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js')
                    .then(function(registration) {
                        console.log('[PWA] Service Worker registrado com sucesso:', registration.scope);

                        // Verificar se hÃ¡ atualizaÃ§Ã£o disponÃ­vel
                        registration.addEventListener('updatefound', function() {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', function() {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // Nova versÃ£o disponÃ­vel
                                    UI.showSuccess('ğŸš€ Nova versÃ£o disponÃ­vel! Atualize a pÃ¡gina para usar a versÃ£o mais recente.', 10000);
                                }
                            });
                        });

                        // Monitorar estado do SW
                        if (registration.active) {
                            console.log('[PWA] Service Worker ativo');
                        }
                    })
                    .catch(function(error) {
                        console.error('[PWA] Falha ao registrar Service Worker:', error);
                    });
            });
        } else {
            console.warn('[PWA] Service Worker nÃ£o suportado neste navegador');
        }

        // Solicitar permissÃ£o para notificaÃ§Ãµes push
        function requestNotificationPermission() {
            if ('Notification' in window && navigator.serviceWorker) {
                Notification.requestPermission().then(function(permission) {
                    if (permission === 'granted') {
                        console.log('[PWA] PermissÃ£o para notificaÃ§Ãµes concedida');
                        // Aqui poderia registrar o token para push notifications
                    } else {
                        console.log('[PWA] PermissÃ£o para notificaÃ§Ãµes negada');
                    }
                });
            }
        }

        // Solicitar instalaÃ§Ã£o do PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', function(e) {
            console.log('[PWA] Evento beforeinstallprompt capturado');
            e.preventDefault();
            deferredPrompt = e;

            // Mostrar botÃ£o de instalaÃ§Ã£o personalizado se desejar
            // showInstallButton();
        });

        // FunÃ§Ã£o para instalar o PWA
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(function(choiceResult) {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('[PWA] UsuÃ¡rio aceitou instalar o PWA');
                    } else {
                        console.log('[PWA] UsuÃ¡rio rejeitou instalar o PWA');
                    }
                    deferredPrompt = null;
                });
            }
        }

        // Detectar se estÃ¡ rodando como PWA
        function isPWA() {
            return window.matchMedia('(display-mode: standalone)').matches ||
                    window.navigator.standalone === true;
        }

        // Executar quando DOM estiver pronto
        document.addEventListener('DOMContentLoaded', function() {
            if (isPWA()) {
                console.log('[PWA] Aplicativo rodando como PWA');
                // Comportamentos especÃ­ficos para PWA
            }

            // Solicitar permissÃ£o para notificaÃ§Ãµes apÃ³s interaÃ§Ã£o do usuÃ¡rio
            document.addEventListener('click', function requestPermissionOnce() {
                requestNotificationPermission();
                document.removeEventListener('click', requestPermissionOnce);
            }, { once: true });
        });

        // VariÃ¡veis globais
        let services = [];

        // InicializaÃ§Ã£o da pÃ¡gina
        document.addEventListener('DOMContentLoaded', async function() {
            addFadeInAnimation();
            await loadServices();
        });

        // Adicionar animaÃ§Ãµes de entrada
        function addFadeInAnimation() {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach((el, index) => {
                el.style.animationDelay = `${index * 0.1}s`;
            });
        }

        // Carregar serviÃ§os
        async function loadServices() {
            try {
                // Tentar carregar serviÃ§os pÃºblicos do backend (nÃ£o requer autenticaÃ§Ã£o)
                const response = await api.getPublicServices();
                services = response || [];
                displayServicesList();
            } catch (error) {
                console.error('Erro ao carregar serviÃ§os:', error);
                // Mostrar dados de exemplo quando nÃ£o conseguir conectar
                console.log('Carregando dados de exemplo...');
                showExampleData();
            }
        }

        // Mostrar dados de exemplo para demonstraÃ§Ã£o
        function showExampleData() {
            services = [
                { id: 1, nome: 'Corte de Cabelo', descricao: 'Corte moderno e estiloso', preco: 50.00, duracao_minutos: 45 },
                { id: 2, nome: 'Manicure', descricao: 'Cuidado completo das unhas', preco: 35.00, duracao_minutos: 30 },
                { id: 3, nome: 'Massagem Relaxante', descricao: 'Massagem terapÃªutica para relaxamento', preco: 80.00, duracao_minutos: 60 },
                { id: 4, nome: 'Limpeza de Pele', descricao: 'Tratamento facial completo', preco: 120.00, duracao_minutos: 90 }
            ];

            displayServicesList();

            // Mostrar aviso sobre dados de demonstraÃ§Ã£o
            setTimeout(() => {
                UI.showSuccess('ğŸ“‹ Dados de demonstraÃ§Ã£o carregados. FaÃ§a login para ver dados reais.');
            }, 1000);
        }

        // Exibir lista de serviÃ§os
        function displayServicesList() {
            const servicesList = document.getElementById('servicesList');

            if (services.length === 0) {
                servicesList.innerHTML = '<p class="text-center">Nenhum serviÃ§o disponÃ­vel no momento.</p>';
                return;
            }

            servicesList.innerHTML = services.map(service => `
                <div class="service-card">
                    <h3>${service.nome || service.name}</h3>
                    <p>${service.descricao || service.description || 'DescriÃ§Ã£o nÃ£o disponÃ­vel'}</p>
                    <div class="d-flex justify-between align-center mt-2">
                        <span class="price">${Formatter.currency(service.preco || service.price)}</span>
                        <span class="badge badge-info">${service.duracao_minutos ? service.duracao_minutos + ' min' : 'Consulte'}</span>
                    </div>
                </div>
            `).join('');
        }
    </script>
</body>

</html>